High-speed Onion Routing at the NETwork layer (HORNET)
======================================================

HORNET (citation [40]] in our paper) aims to guarantee privacy by utilizing the
onion routing at the network layer, while achieving scalability by removing
states on the relays.

<img src="hornet_record.jpg"></img>

The above MSC describes a procedure of data transmission.

Note that all the relays have their own local secret keys which is described
as:
&nbsp;&nbsp;<img src="https://latex.codecogs.com/gif.latex?k_B"/>: a local
secret key of <img src="https://latex.codecogs.com/gif.latex?B" /><br>
&nbsp;&nbsp;<img src="https://latex.codecogs.com/gif.latex?k_C"/>: a local
secret key of <img src="https://latex.codecogs.com/gif.latex?C" /><br>

The followings are established at the setup phase of the HORNET protocol.
&nbsp;&nbsp;<img src="https://latex.codecogs.com/gif.latex?k_AB"/>: a shared
key between <img src="https://latex.codecogs.com/gif.latex?A" /> and <img
src="https://latex.codecogs.com/gif.latex?B" /><br>
&nbsp;&nbsp;<img src="https://latex.codecogs.com/gif.latex?{(k_{AB},
C)}_{k_{B}}"/>: a forward segment generated by <img src="https://latex.codecogs.com/gif.latex?B" /> that contains a shared key and the next hop information. It is encrypted with a local secret key <img src="https://latex.codecogs.com/gif.latex?B" /> and is delivered to a client (<img src="https://latex.codecogs.com/gif.latex?A" /> at the setup phase.<br>

When a client wants to send a payload <img
src="https://latex.codecogs.com/gif.latex?p"/>,
he/she sends <img src="https://latex.codecogs.com/gif.latex?p" /> together with
BackwardHdr that includes the information about the backward path as <img
src="https://latex.codecogs.com/gif.latex?msg" />.
The message <img src="https://latex.codecogs.com/gif.latex?msg" /> is
onion-encrypted with shared keys.
Finally, ForwardHdr that contains the information about the forward path is sent 
with the encrypted message.

When a relay receives what a client sends, it fetches a shared key <img
src="https://latex.codecogs.com/gif.latex?k_{AB}"/> and
the next hop <img src="https://latex.codecogs.com/gif.latex?C"/>, decrypts an
onion-encrypted message, and sends the resultant message to the next hop.
